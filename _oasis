OASISFormat: 0.4
Name:        tcpip
Version:     2.4.3
Synopsis:    Ethernet, TCP/IPv4 and DHCPv4 library
Authors:     Anil Madhavapeddy, Balraj Singh, Richard Mortier,
             Nicolas Ojeda Bar, Thomas Gazagnaire
License:     ISC
Plugins:     META (0.4), DevFiles (0.4)
BuildTools:  ocamlbuild
PostConfCommand: ocaml postconf.ml

Flag xen
  Description:        Build Xen support
  Default:            false

Library tcpip
  CompiledObject:     best
  Path:               lib
  Findlibname:        tcpip
  Modules:            Wire_structs, Tcpip_checksum
  CSources:           checksum_stubs.c
  CCOpt:              -O2 -fno-stack-protector
  BuildDepends:       io-page,mirage-types,ipaddr,cstruct,mirage-profile,bytes
  XMETAExtraLines:    xen_linkopts = "-ltcpip_xen_stubs"

Library ipv4
  CompiledObject:     best
  Path:               lib
  Findlibparent:      tcpip
  Findlibname:        ipv4
  Modules:            Ipv4, Arpv4
  BuildDepends:       io-page,mirage-types,ipaddr,cstruct,lwt,tcpip

Library ipv6
  CompiledObject:     best
  Path:               lib
  Findlibparent:      tcpip
  Findlibname:        ipv6
  Modules:            Ipv6, Ndpv6
  BuildDepends:       io-page,mirage-types,ipaddr,cstruct,lwt,tcpip

Library udp
  CompiledObject:     best
  Path:               lib
  Findlibparent:      tcpip
  Findlibname:        udp
  Modules:            Udp
  BuildDepends:       io-page,mirage-types,ipaddr,cstruct,lwt,tcpip

Library tcp
  CompiledObject:     best
  Pack:               true
  Path:               tcp
  Findlibparent:      tcpip
  Findlibname:        tcp
  Modules:            Options,Wire,State,Tcptimer,Sequence,Ack,
                      Window,Segment,User_buffer,Pcb,Flow
  BuildDepends:       io-page,
                      mirage-types,
                      ipaddr,
                      cstruct,
                      lwt,
                      tcpip,
                      tcpip.ipv4,
                      tcpip.ipv6

Library channel
  CompiledObject:     best
  Path:               channel
  Findlibparent:      tcpip
  Findlibname:        channel
  Modules:            Channel
  BuildDepends:       io-page,
                      mirage-types,
                      ipaddr,
                      cstruct,
                      lwt

Library dhcpv4
  CompiledObject:     best
  Path:               dhcp
  Findlibparent:      tcpip
  Findlibname:        dhcpv4
  Modules:            Dhcpv4_option,Dhcp_clientv4
  BuildDepends:       io-page, bytes,
                      mirage-types,
                      ipaddr,
                      cstruct,
                      lwt,
                      tcpip.udp

Library "udpv4-socket"
  CompiledObject:     best
  Path:               unix
  Findlibparent:      tcpip
  Findlibname:        udpv4-socket
  Modules:            Udpv4_socket
  BuildDepends:       tcpip.udp,
                      lwt,
                      lwt.unix,
                      ipaddr.unix,
                      cstruct.lwt,
                      io-page.unix

Library "udpv6-socket"
  CompiledObject:     best
  Path:               unix
  Findlibparent:      tcpip
  Findlibname:        udpv6-socket
  Modules:            Udpv6_socket
  BuildDepends:       tcpip.udp,
                      lwt,
                      lwt.unix,
                      ipaddr.unix,
                      cstruct.lwt,
                      io-page.unix

Library "tcpv4-socket"
  CompiledObject:     best
  Path:               unix
  Findlibparent:      tcpip
  Findlibname:        tcpv4-socket
  Modules:            Tcpv4_socket
  BuildDepends:       lwt,
                      lwt.unix,
                      ipaddr.unix,
                      cstruct.lwt,
                      io-page.unix

Library "tcpv6-socket"
  CompiledObject:     best
  Path:               unix
  Findlibparent:      tcpip
  Findlibname:        tcpv6-socket
  Modules:            Tcpv6_socket
  BuildDepends:       lwt,
                      lwt.unix,
                      ipaddr.unix,
                      cstruct.lwt,
                      io-page.unix

Library "tcpip-stack-socket"
  CompiledObject:     best
  Path:               unix
  Findlibparent:      tcpip
  Findlibname:        stack-socket
  Modules:            Tcpip_stack_socket, Ipv4_socket, Ipv6_socket
  BuildDepends:       tcpip.udpv4-socket, tcpip.udpv6-socket,
                      tcpip.tcpv4-socket, tcpip.tcpv6-socket,
                      lwt,
                      lwt.unix,
                      ipaddr.unix,
                      io-page.unix

Executable test
  Build$: flag(tests)
  Path: lib_test
  Custom: true
  MainIs: test.ml
  ByteOpt: -g
  BuildDepends: alcotest, oUnit, lwt, lwt.unix, io-page.unix, tcpip.channel,
                mirage-flow, mirage-vnetif, mirage-console.unix, tcpip.ethif, tcpip.tcp

Test test
  Run$: flag(tests)
  Command: $test
